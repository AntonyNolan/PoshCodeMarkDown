---
Author: waldo
Publisher: 
Copyright: 
Email: 
Version: 4.0.0
Encoding: ascii
License: cc0
PoshCode ID: 1524
Published Date: 
Archived Date: 2011-01-10t08
---

# vim25 crazy magic - 

## Description

interface with vimservice on esxi.

## Comments



## Usage



## TODO



## 

``

## Code

`#
 #
 cls
 
 [void][Reflection.Assembly]::LoadWithPartialName("VMware.Vim");
 
 $ws  =  New-WebServiceProxy -Uri "http://172.16.0.33/sdk/vimService?wsdl" ;
 $ws.Url = "http://172.16.0.33/sdk/vimService";
 $ws.UserAgent = "VMware VI Client/4.0.0";
 
 $vimClient = New-Object Vmware.Vim.VimClient;
 $servicecontent  = $vimClient.Connect("http://172.16.0.33/sdk");
 $usersession = $vimClient.Login("root","root");
 
 $myMoRef = new-object Microsoft.PowerShell.Commands.NewWebserviceProxy.AutogeneratedTypes.WebServiceProxy172_16_0_33_sdk_vimService_wsdl.ManagedObjectReference;
 $myMoRef.type = "HostSystem";
 $myMoRef.Value = "ha-host";
 
 $ws.CookieContainer = $vimClient.VimService.CookieContainer;
 
 $ret = New-Object  Microsoft.PowerShell.Commands.NewWebserviceProxy.AutogeneratedTypes.WebServiceProxy172_16_0_33_sdk_vimService_wsdl.ManagedObjectReference;
 $ret = $ws.RebootHost_Task($myMoRef,$true);
 $ret;
 $vimClient.Logout();
 
 exit
 
`

