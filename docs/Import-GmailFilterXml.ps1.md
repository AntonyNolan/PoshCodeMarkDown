---
Author: 
Publisher: 
Copyright: 
Email: 
Version: 0.1
Encoding: ascii
License: cc0
PoshCode ID: 960
Published Date: 
Archived Date: 2009-03-29t05
---

# import-gmailfilterxml - 

## Description

gmail can now import and export filters as xml. this script will read in an xml file generated by gmail (the path parameter), and create from it a flat psobject with id, updated, name and value fields.  since it is flat, you must use the id field to correlate the filter criteria and actions.  as far as i can tell, the first item in a filter is the criteria, and any subsequent ones describe the action to take.  more info about filter import/export can be found here

## Comments



## Usage



## TODO

– script the actual export of filters from gmail, removing need for working with the file at all – display in a treeview to better visualize the multiple items in each entry.

## 

``

## Code

`#
 #
 param (
 	$Path
 )
 [xml]$flt = Get-Content -Path $Path
 $title = $flt.feed.title
 $author = $flt.feed.author.name
 $output = @()
 foreach ( $entry in $flt.feed.entry ) {
 	foreach ( $property in $entry.property ) {
 		foreach ($item in $property) {
 			$process = "" | select Id, Updated, Name, Value
 			$process.Id = $entry.Id
 			$process.Updated = [datetime]$entry.Updated
 			$process.Name = $item.Name
 			$process.Value = $item.Value
 			$output += $process
 		}
 	}
 }
 $output
`

