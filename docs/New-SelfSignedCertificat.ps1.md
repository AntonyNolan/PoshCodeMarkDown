---
Author: lee holmes
Publisher: 
Copyright: 
Email: 
Version: 0.1
Encoding: ascii
License: cc0
PoshCode ID: 2201
Published Date: 2011-09-09t21
Archived Date: 2016-03-19t02
---

# new-selfsignedcertificat - 

## Description

from windows powershell cookbook (oâ€™reilly) by lee holmes

## Comments



## Usage



## TODO



## script

``

## Code

`#
 #
 ##############################################################################
 ##
 ##
 ##
 ##############################################################################
 
 <#
 
 .SYNOPSIS
 
 Generate a new self-signed certificate. The certificate generated by these
 commands allow you to sign scripts on your own computer for protection
 from tampering. Files signed with this signature are not valid on other
 computers.
 
 .EXAMPLE
 
 New-SelfSignedCertificate.ps1
 Creates a new self-signed certificate
 
 #>
 
 Set-StrictMode -Version Latest
 
 if(-not (Get-Command makecert.exe -ErrorAction SilentlyContinue))
 {
     $errorMessage = "Could not find makecert.exe. " +
         "This tool is available as part of Visual Studio, or the Windows SDK."
 
     Write-Error $errorMessage
     return
 }
 
 $keyPath = Join-Path ([IO.Path]::GetTempPath()) "root.pvk"
 
 makecert -n "CN=PowerShell Local Certificate Root" -a sha1 `
     -eku 1.3.6.1.5.5.7.3.3 -r -sv $keyPath root.cer `
     -ss Root -sr localMachine
 
 makecert -pe -n "CN=PowerShell User" -ss MY -a sha1 `
     -eku 1.3.6.1.5.5.7.3.3 -iv $keyPath -ic root.cer
 
 Remove-Item $keyPath
 
 Get-ChildItem cert:\currentuser\my -codesign |
     Where-Object { $_.Subject -match "PowerShell User" }
`

